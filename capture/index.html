<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AutoCaster View</title>

  <!-- keep this if you already serve /hls.js -->
  <script src="../hls.js"></script>

  <link href="https://fonts.googleapis.com/css?family=Poppins:400,500,600,700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./assets/css/capture.css" />
</head>

<body>

  <!-- OFFLINE OVERLAY -->
  <div id="offlineOverlay" class="tc-offline-overlay" aria-hidden="true">
    <div class="tc-offline-card">
      <h2 class="tc-offline-title">
        <span class="tc-offline-icon">📷</span>
        <span id="offlineTitle">カメラがオフラインです</span>
      </h2>
      <p class="tc-offline-sub" id="offlineMsg">
        現在このカメラは利用できません。しばらくしてから再度お試しください。
      </p>
      <div class="tc-offline-badge">
        🔴 <span id="offlineBadge">OFFLINE</span>
      </div>

      <div class="tc-offline-actions">
        <button class="tc-btn tc-btn-primary" id="offlineRetryBtn" type="button">再試行</button>
        <button class="tc-btn tc-btn-ghost" id="offlineCloseBtn" type="button">閉じる</button>
      </div>

      <div class="tc-muted" id="offlineHint"></div>
    </div>
  </div>

  <!-- IN-USE OVERLAY -->
<div id="inUseOverlay" class="tc-offline-overlay" aria-hidden="true" style="display:none;">
  <div class="tc-offline-card">
    <h2 class="tc-offline-title">
      <span class="tc-offline-icon">⛔</span>
      <span>Camera is currently in use</span>
    </h2>

    <p class="tc-offline-sub">
      他のユーザーがこのカメラを利用中です。しばらくしてから再度お試しください。
    </p>

    <div class="tc-offline-badge" style="background: rgba(255,165,0,0.12); border-color: rgba(255,165,0,0.35);">
      🟠 <span>IN USE</span>
    </div>

    <div class="tc-offline-actions">
      <button class="tc-btn tc-btn-primary" id="inUseBackBtn" type="button">← 戻る</button>
      <!-- <button class="tc-btn tc-btn-ghost" id="inUseRetryBtn" type="button">再試行</button> -->
    </div>

    <div class="tc-muted" id="inUseHint"></div>
  </div>
</div>

<!-- CONFIRM CANCEL OVERLAY -->
<div id="confirmCancelOverlay" class="tc-overlay" aria-hidden="true">
  <div class="tc-overlay-card">
    <h2 class="tc-overlay-title">
      <span class="tc-overlay-icon">⚠️</span>
      本当にキャンセルしますか？
    </h2>

    <p class="tc-overlay-sub">
      現在の撮影データは破棄されます。
    </p>

    <div class="tc-overlay-actions">
      <button id="confirmCancelYes" class="tc-btn tc-btn-primary" type="button">
        はい
      </button>

      <button id="confirmCancelNo" class="tc-btn tc-btn-ghost" type="button">
        戻る
      </button>
    </div>
  </div>
</div>


  <!-- ===================== HOME ===================== -->
  <section class="home" id="startHero">
    <div class="home-bg"></div>
    <div class="home-gradient"></div>

    <div class="home-content">
      <p class="home-kicker">記念撮影カメラシステム</p>
      <h1 class="home-title">AutoCaster View</h1>

      <div class="home-cards">
        <div class="home-card">
          <div class="home-card-icon">📷</div>
          <p class="home-card-label">静止画</p>
          <p class="home-card-price">¥100</p>
        </div>

        <div class="home-card">
          <div class="home-card-icon">🎥</div>
          <p class="home-card-label">3秒動画</p>
          <p class="home-card-price">¥300</p>
        </div>

        <div class="home-card">
          <div class="home-card-icon">🎥</div>
          <p class="home-card-label">15秒動画</p>
          <p class="home-card-price">¥500</p>
        </div>
      </div>

      <p class="home-note-strong">撮影・プレビューまでは無料で行うことができます</p>

      <div class="home-pill">
        <span class="home-pill-strong">データ取得：</span>
        <span>ダウンロード方式</span>
      </div>

      <div class="home-camera-badge">
        <span class="dot"></span>
        <span id="heroCameraText">Camera: —</span>
      </div>

      <button class="home-start" id="btnUseService" type="button">
        <span class="home-start-icon">📷</span>
        スタート
      </button>

      <p class="home-foot">
        設置された撮影用カメラで、写真、3秒動画、15秒動画の記念撮影とそのデータのダウンロードが可能です。
      </p>

      <p class="home-devhint" id="heroNote">URLに cameraId が必要です（例：?cameraId=xxxx）</p>
    </div>
  </section>

  <!-- ===================== MODE SELECTION (FULL SCREEN PAGE) ===================== -->
  <section class="home" id="modePage" style="display:none;">
    <div class="home-bg"></div>
    <div class="home-gradient"></div>

    <div class="home-content">
      <p class="home-kicker">記念撮影カメラシステム</p>
      <h1 class="home-title">AutoCaster View</h1>

      <div class="modal-card" style="margin-top:14px;">
        <h2 class="modal-title" style="margin-top:0;">撮影モードを選択</h2>
        <p class="modal-sub">お好みのモードをお選びください</p>

        <div class="modal-actions">
          <button id="btnStartPhoto" class="mode-btn mode-green" type="button">
            <span class="mode-icon">📷</span>
            <span class="mode-text">
              <span class="mode-name">静止画</span>
              <span class="mode-desc">高画質スチル撮影</span>
            </span>
          </button>

          <button id="btnDur3" class="mode-btn mode-blue" type="button">
            <span class="mode-icon">🎥</span>
            <span class="mode-text">
              <span class="mode-name">動画（3秒）</span>
              <span class="mode-desc">ショートムービー撮影</span>
            </span>
          </button>

          <button id="btnDur15" class="mode-btn mode-blue" type="button">
            <span class="mode-icon">🎥</span>
            <span class="mode-text">
              <span class="mode-name">動画（15秒）</span>
              <span class="mode-desc">ショートムービー撮影</span>
            </span>
          </button>
        </div>

        <button id="btnModeClose" class="modal-back" type="button">← 戻る</button>
      </div>
    </div>
  </section>

 <!-- ===================== LIVE PAGE (Preparation for filming style) ===================== -->
<div class="app prep-v2" id="livePage" style="display:none;">

  <h1 class="prepTitle">撮影準備</h1>

  <div class="prepPills">
    <div class="pill2">
      <span>ライブ</span>
      <span class="dotGreen"></span>
    </div>

    <div class="pill2">
      <span>選択モード：</span>
      <b id="modeText2">Photo</b>
    </div>
  </div>

  <section class="preview-card prepPreviewCard">
    <div class="preview-top">
      <div class="preview-left">
        <span class="preview-sub" id="liveCardTitle">ライブビュ</span>
      </div>
      <div class="overlay-chip" id="liveOverlayPill">Overlay: <b id="liveOverlayName">none</b></div>
    </div>

    <div class="preview-media">
      <video id="liveVideo" autoplay muted playsinline></video>

      <div class="preview-overlay" id="liveOverlay">
        <img id="liveFrame" class="preview-frame" alt="live frame"/>
        <img id="liveLogo" class="preview-logo pos-top-left" alt="live logo"/>
      </div>

      <div class="preview-corner-icon" aria-hidden="true">📹</div>
    </div>
  </section>

  <!-- Select overlay row (like attachment) -->
  <div class="overlayRowHeaderV2">フレーム/ロゴを選択
    <div>
     <!--  <div class="rowTitleV2">フレーム/ロゴを選択</div>
       <div class="rowHintV2">写真やビデオにフレームやロゴなどを追加</div> -->
    </div>
    <button id="btnSeeAllOverlays" class="linkBtnV2" type="button">全て</button>
  </div>

  <!-- rail (shows few items like screenshot) -->
  <div id="overlayRailV2" class="overlayRailV2"></div>

  <!-- shoot / return -->
  <button id="btnLiveCapture" class="shootBtnV2" type="button">📷 撮影</button>
  <button id="btnLiveClose" class="returnBtnV2" type="button">← 戻る</button>

  <div class="status" id="liveStatus">準備中…</div>
</div>

<!-- ======= See All Modal ======= -->
<div id="overlayModalV2" class="modalV2 hidden" aria-hidden="true">
  <div class="modalBackdropV2" id="overlayModalBackdrop"></div>
  <div class="modalCardV2">
    <div class="modalHeadV2">
      <b>Choose frame / logo</b>
      <button id="btnCloseOverlayModal" class="xBtnV2" type="button">✕</button>
    </div>

    <div class="modalTabsV2">
      <button class="tabV2 active" id="tabAll" type="button">All</button>
      <button class="tabV2" id="tabFrames" type="button">Frames</button>
      <button class="tabV2" id="tabLogos" type="button">Logos</button>
    </div>

    <div id="overlayGridV2" class="overlayGridV2"></div>
  </div>
</div>


  <!-- ===================== APP (Prep + Preview) ===================== -->
  <div class="app" id="appContainer">
    <header class="app-header">
      <div>
        <p class="app-kicker">記念撮影カメラシステム</p>
        <h1 class="app-title">AutoCaster View</h1>
      </div>
      <div class="app-right">
        <div class="app-badge" id="badge">Camera: —</div>
      </div>
    </header>

    <!-- ===== Preview header (attachment style) ===== -->
<div class="previewHeader" id="previewHeader" style="display:none;">
  <h2 class="previewTitle">撮影プレビュー</h2>

  <div class="previewPills">
    <div class="previewPill" id="previewFramePill">フレーム: 無</div>
    <div class="previewPill" id="previewModePill">選択モード: 写真</div>
  </div>
</div>


    <div class="status-row">
      <div class="status-chip">
        <span class="status-dot" id="liveDot"></span>
        <span class="pill off" id="livePill">OFF</span>
      </div>

      <div class="mode-chip">
        <span class="mode-chip-label">選択モード：</span>
        <span class="mode-chip-value" id="modePill">動画 3秒 (¥300)</span>
      </div>
    </div>

    <div class="page-head">
      <h2 class="page-title" id="pageTitle">撮影準備</h2>
      <p class="page-hint" id="pageHint">フレーム / ロゴを選んで「開始」へ</p>
    </div>

    <div id="blurTarget" class="blur-target hide-overlay">

      <section class="preview-card">
        <div class="preview-top">
          <div class="preview-left">
            <span class="preview-sub" id="cardTitle">準備プレビュー</span>
          </div>
          <div class="overlay-chip" id="overlayPill">Overlay: None</div>
        </div>

        <div class="preview-media">
          <video id="video" autoplay muted playsinline></video>
          <img id="photoPreview" alt="photo preview" />

          <div class="preview-overlay" id="previewOverlay">
            <img id="framePreview" class="preview-frame" alt="frame preview"/>
            <img id="logoPreview" class="preview-logo pos-top-left" alt="logo preview"/>
          </div>

          <div class="preview-corner-icon" aria-hidden="true">🖼️</div>
        </div>

   
      </section>

      <section class="overlay-card">
        <div class="overlay-card-head">
          <div>
            <div class="overlay-card-title">オーバーレイ選択</div>
            <div class="overlay-card-hint">フレームとロゴを選んでプレビューに反映</div>
          </div>
          <div class="overlay-chip" id="overlayPill2">Overlay: None</div>
        </div>

        <div class="overlay-row" id="frameSection">
          <div class="overlay-row-head">
            <div class="overlay-row-title">フレーム</div>
            <button class="overlay-clear" id="clearFrameBtn" type="button">クリア</button>
          </div>
          <div class="strip compact" id="frames"></div>
        </div>

        <div class="overlay-row" id="logoSection">
          <div class="overlay-row-head">
            <div class="overlay-row-title">ロゴ</div>
            <button class="overlay-clear" id="clearLogoBtn" type="button">クリア</button>
          </div>
          <div class="strip compact" id="logos"></div>
        </div>
      </section>

      <div class="controls" id="prepControls">
        <button id="btnPrepStart" class="btn-primary">開始</button>
      </div>

      <div class="controls" id="previewControls" style="display:none">
        <button id="btnDownload" class="btn-success" type="button">決済/ダウンロード</button>
        <button id="btnBackToPrep" class="btn-ghost" type="button">× キャンセル</button>

      </div>

      <div class="status" id="status">待機中…</div>
    </div>
  </div>

  <!-- CAPTURE MODAL (keep) -->
  <div id="captureModal" class="modal" aria-hidden="true">
    <div class="modal-card">
      <div class="modal-title-strong" id="captureTitle">撮影中…</div>

      <div class="countdown-num" id="countdownNum">5</div>

      <div class="processing" id="processingBox">
        <div class="processing-title" id="processingText">処理中…</div>
        <div class="progress"><div class="progress-bar"></div></div>
        <div class="meta">
          <span id="procHint">目安: ~10s</span>
          <span id="procTick">0s</span>
        </div>
      </div>

      <div class="modal-actions-row">
        <button id="btn-modal-cancel" class="btn-danger" type="button">キャンセル</button>
        <button id="btn-modal-hide" class="btn-ghost" type="button" style="display:none;">閉じる</button>
      </div>
    </div>
  </div>

  <!-- Main JS (ESM) -->
  <script type="module" src="./assets/js/main.js"></script>
</body>
</html>
